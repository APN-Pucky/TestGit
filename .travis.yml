language: cpp
matrix:
  include:
  - env:
    - TUO_PLATFORM='windowsXX'
    - TUO_FILE_32='tuo_x86.exe'
    - TUO_FILE_64='tuo.exe'
    os: linux
    dist: trusty
    sudo: required
    compiler: gcc
  - env:
    - TUO_PLATFORM='macXX'
    - TUO_FILE_32='tuo_x86.osx'
    - TUO_FILE_64='tuo.osx'
    os: osx
before_install:
- TUO_TARGET="${TUO_PLATFORM::${#TUO_PLATFORM}-2}"
- "./build/${TUO_TARGET}/requirements.sh"
install:
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then make rebuild -f Makefile.osx VERSION=$TRAVIS_TAG; fi
- if [[ ! "$TRAVIS_OS_NAME" == "osx" ]]; then source ./build/${TUO_TARGET}/build.sh; fi
script:
- echo "NOP"
before_deploy:
- "./update_xml.sh"
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then cp tuo.osx $TUO_FILE_32; fi
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then cp tuo.osx $TUO_FILE_64; fi
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; export TUO_FILE_ZIP="tuo.${TRAVIS_TAG}_32+64_bit_osx.zip"; fi
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; zip -r "$TUO_FILE_ZIP" data/ "$TUO_FILE_32" "$TUO_FILE_64"; fi
- if [[ ! "$TRAVIS_OS_NAME" == "osx" ]]; then source build/${TUO_TARGET}/package.sh; fi
deploy:
  provider: releases
  name: "${TRAVIS_COMMIT_MESSAGE}"
  api_key:
    secure: jY8H/qppcRs1C9lM1Q+9DB6pTrxsXn51XMuBietd28MBUHjQJH2Nh0SzTGWogUFKXV3RuXXdDp3eRr9NidyLzX/awDGgED04THDV5+ba9qpJEP5vItC1ZG52RteRET9RSUqvqXETP6juvuyUb+caiFA7cTkPetEJyEI8lcXbctS1S6t99A/uX3LjOmsz3bEw1MJ4vES6acuwXSzTwPorRCuydpyugMZLkAxl9v5s/eBJ1cg39Ly2yzbgZR3RzRCgzzACj5yEjyTksiyBmBGwbfIN8UvQZLprJOFE0j2/ZB9aGU0q/p6ICM54pJMzdJLjcz9k8cN4iM/5YEJaybnECXggOEb8cfTcwifO4dyMYXGdYqvSest6YI8hQF0P37ibos0UxefljV2XKCAKd+H59LaPgkxZ9XICZ+4M+GU3jjkprl00bjbdOWAsEBRupDI6Umi+jbgwf/UjnjfOCjnCZYp3atn31PSIJbusrHjxhJf5BTHlgGDibn/+jIDVxZ+5rpAsezEsHKNDucwwOSXuV4kglzuN325gmt3P0WYM0gCI8UR/ax9lpy2mwUbc1XzYE8yqLc7vqzLtMu94LUH5BXipErK0XncTj2LUF2vfExXXBORIJiPdA83OxV9GoP00WfD8WwjeWZa1VWHHY5crEpGVE3FAHGlRBn/xRwYh6lc=
  file:
  - "${TUO_FILE_32}"
  - "${TUO_FILE_64}"
  - "${TUO_FILE_ZIP}"
  skip_cleanup: true
  on:
    tags: true
